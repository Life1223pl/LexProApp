{% extends 'base.html.twig' %}

{% block title %}Admin: Pracownicy{% endblock %}

{% block body %}
    <div style="max-width: 1100px; margin: 24px auto;">
        <h1>Pracownicy</h1>

        {% for message in app.flashes('success') %}
            <div style="padding:10px;border:1px solid #0a0;background:#efe;margin:10px 0;">{{ message }}</div>
        {% endfor %}

        <h2>Niezatwierdzone konta</h2>
        {% if niezweryfikowani is empty %}
            <p>Brak.</p>
        {% else %}
            <table border="1" cellpadding="6" cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th>ID</th><th>Email</th><th>Imię</th><th>Nazwisko</th><th>Akcje</th>
                </tr>
                </thead>
                <tbody>
                {% for p in niezweryfikowani %}
                    <tr>
                        <td>{{ p.id }}</td>
                        <td>{{ p.email }}</td>
                        <td>{{ p.imie }}</td>
                        <td>{{ p.nazwisko }}</td>
                        <td>
                            <a href="{{ path('admin_pracownicy_edit', {id: p.id}) }}">Edytuj</a>

                            <form method="post" action="{{ path('admin_pracownicy_verify', {id: p.id}) }}" style="display:inline;">
                                <input type="hidden" name="_token" value="{{ csrf_token('verify_' ~ p.id) }}">
                                <button type="submit">Zatwierdź</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}

        <hr>

        <h2>Wszyscy</h2>
        <table border="1" cellpadding="6" cellspacing="0" width="100%">
            <thead>
            <tr>
                <th>ID</th><th>Email</th><th>Imię</th><th>Nazwisko</th><th>Zatw.</th><th>Aktyw.</th><th>Przełożony</th><th>Akcje</th>
            </tr>
            </thead>
            <tbody>
            {% for p in wszyscy %}
                <tr>
                    <td>{{ p.id }}</td>
                    <td>{{ p.email }}</td>
                    <td>{{ p.imie }}</td>
                    <td>{{ p.nazwisko }}</td>
                    <td>{{ p.isVerified ? 'TAK' : 'NIE' }}</td>
                    <td>{{ p.isActive ? 'TAK' : 'NIE' }}</td>
                    <td>
                        {% if p.przelozony %}
                            {{ p.przelozony.imie }} {{ p.przelozony.nazwisko }}
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ path('admin_pracownicy_edit', {id: p.id}) }}">Edytuj</a>
                        <form method="post" action="{{ path('admin_pracownicy_deactivate', {id: p.id}) }}" style="display:inline;">
                            <input type="hidden" name="_token" value="{{ csrf_token('deactivate_' ~ p.id) }}">
                            <button type="submit">Dezaktywuj</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
